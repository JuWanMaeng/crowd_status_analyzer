device:cuda:2, mode:emotion, backbone:SwinT
emotion
total train data:73437
total val data:9180
total test data:9176
************************************************************
1/100 current_lr:0.001
































































train: |██████████████████████████████████████| 287/287 [02:10<00:00,  2.20it/s]


val: |████████████████████████████████████████| 287/287 [00:06<00:00, 42.22it/s]
train: |                                                | 0/287 [00:00<?, ?it/s]
Copied best model weights!
train loss: 1.509605, val loss: 1.498547, val_accuracy: 38.75
************************************************************
































































train: |██████████████████████████████████████| 287/287 [02:09<00:00,  2.21it/s]


val: |████████████████████████████████████████| 287/287 [00:06<00:00, 42.21it/s]
train: |                                                | 0/287 [00:00<?, ?it/s]
Copied best model weights!
train loss: 1.495345, val loss: 1.489923, val_accuracy: 39.17
************************************************************
































































train: |██████████████████████████████████████| 287/287 [02:09<00:00,  2.21it/s]



val: |██████████████████████████████████████▎ | 275/287 [00:06<00:00, 42.29it/s]
train loss: 1.499431, val loss: 1.496382, val_accuracy: 37.98
************************************************************
val: |████████████████████████████████████████| 287/287 [00:06<00:00, 41.99it/s]
































































train: |██████████████████████████████████████| 287/287 [02:10<00:00,  2.21it/s]


val: |████████████████████████████████████████| 287/287 [00:06<00:00, 41.84it/s]
train: |                                                | 0/287 [00:00<?, ?it/s]
train loss: 1.499065, val loss: 1.498943, val_accuracy: 38.00
************************************************************
































































train: |██████████████████████████████████████| 287/287 [02:10<00:00,  2.20it/s]



val: |███████████████████████████████████████▌| 284/287 [00:06<00:00, 42.20it/s]
train loss: 1.499423, val loss: 1.499584, val_accuracy: 38.00
************************************************************
val: |████████████████████████████████████████| 287/287 [00:06<00:00, 41.91it/s]































































train: |██████████████████████████████████████| 287/287 [02:09<00:00,  2.21it/s]



val: |████████████████████████████████████▉   | 265/287 [00:06<00:00, 42.32it/s]
train loss: 1.499437, val loss: 1.500309, val_accuracy: 38.00
************************************************************
val: |████████████████████████████████████████| 287/287 [00:06<00:00, 42.07it/s]































































train: |██████████████████████████████████████| 287/287 [02:09<00:00,  2.21it/s]


val: |████████████████████████████████████████| 287/287 [00:06<00:00, 41.75it/s]
train: |                                                | 0/287 [00:00<?, ?it/s]
train loss: 1.499504, val loss: 1.499339, val_accuracy: 38.00
************************************************************
































































train: |██████████████████████████████████████| 287/287 [02:09<00:00,  2.21it/s]


val: |████████████████████████████████████████| 287/287 [00:06<00:00, 41.81it/s]
train: |                                                | 0/287 [00:00<?, ?it/s]
train loss: 1.499268, val loss: 1.498610, val_accuracy: 38.00
************************************************************
































































train: |██████████████████████████████████████| 287/287 [02:10<00:00,  2.21it/s]



val: |█████████████████████████████████████▍  | 269/287 [00:06<00:00, 42.09it/s]
train loss: 1.499352, val loss: 1.500459, val_accuracy: 38.00
************************************************************
val: |████████████████████████████████████████| 287/287 [00:06<00:00, 41.84it/s]






















train: |█████████████▎                        | 101/287 [00:46<01:25,  2.18it/s]
Traceback (most recent call last):
  File "train_single_task.py", line 52, in <module>
    train_loss, train_metric = loss_epoch(model, criterion, train_dl,device, phase='train',opt=optimizer)
  File "/home/joowan/Desktop/face_pr/utils/train_utils.py", line 51, in loss_epoch
    loss_b, metric_b = loss_batch(loss_func, output, label, opt)
  File "/home/joowan/Desktop/face_pr/utils/train_utils.py", line 22, in loss_batch
    metric_b = metric_batch(output, target)
  File "/home/joowan/Desktop/face_pr/utils/train_utils.py", line 15, in metric_batch
    corrects = pred.eq(target.view_as(pred)).sum().item()
KeyboardInterrupt